<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ü–ª–∞–Ω –∑–∞—É—á–∏–≤–∞–Ω–∏—è –ö–æ—Ä–∞–Ω–∞ ‚Äî –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            font-size: 12pt;
            line-height: 1.5;
            background: #f5f5f5;
        }

        .setup-form {
            max-width: 550px;
            margin: 50px auto;
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .setup-form h1 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 20pt;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            font-size: 12pt;
            border: 2px solid #ddd;
            border-radius: 5px;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: #333;
            outline: none;
        }

        .form-group small {
            display: block;
            margin-top: 5px;
            color: #666;
            font-size: 10pt;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .info-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 5px;
            padding: 12px;
            margin-bottom: 20px;
            font-size: 10pt;
        }

        .info-box.auto-detected {
            background: #d4edda;
            border-color: #28a745;
        }

        .btn {
            width: 100%;
            padding: 15px;
            font-size: 14pt;
            font-weight: bold;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .btn:hover {
            background: #555;
        }

        .btn-secondary {
            background: #6c757d;
            margin-top: 5px;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .tables-container {
            display: none;
        }

        .action-buttons {
            max-width: 500px;
            margin: 20px auto;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .action-buttons button {
            flex: 1;
            min-width: 200px;
        }

        .print-btn {
            padding: 15px 30px;
            font-size: 14pt;
            font-weight: bold;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .print-btn:hover {
            background: #555;
        }

        .download-btn {
            padding: 15px 30px;
            font-size: 14pt;
            font-weight: bold;
            background: #28a745;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .download-btn:hover {
            background: #218838;
        }

        .download-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .back-btn {
            display: block;
            max-width: 500px;
            margin: 10px auto;
            padding: 12px 30px;
            font-size: 12pt;
            background: #fff;
            color: #333;
            border: 2px solid #333;
            border-radius: 5px;
            cursor: pointer;
        }

        .back-btn:hover {
            background: #f0f0f0;
        }

        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .loading-content {
            background: #fff;
            padding: 30px 50px;
            border-radius: 10px;
            text-align: center;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #333;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .page {
            background: #fff;
            max-width: 800px;
            margin: 20px auto;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            page-break-after: always;
        }

        .page:last-of-type {
            page-break-after: avoid;
        }

        .page.rtl {
            direction: rtl;
            font-family: 'Traditional Arabic', 'Simplified Arabic', Arial, sans-serif;
        }

        h1.page-title {
            text-align: center;
            font-size: 18pt;
            margin-bottom: 15px;
        }

        .header-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            padding: 12px;
            border: 2px solid #333;
            flex-wrap: wrap;
        }

        .header-field {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 10pt;
        }

        .header-value {
            font-weight: bold;
            border-bottom: 2px solid #333;
            padding: 0 6px;
        }

        .week-title {
            background: #333;
            color: #fff;
            padding: 10px 20px;
            font-size: 13pt;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f0f0f0;
            border: 1px solid #333;
            padding: 8px 4px;
            font-size: 8pt;
            text-align: center;
            font-weight: bold;
        }

        td {
            border: 1px solid #333;
            padding: 8px 4px;
            text-align: center;
            font-size: 8pt;
        }

        .day-num {
            font-weight: bold;
            width: 35px;
            background: #f9f9f9;
        }

        .exam-row {
            background: #e0e0e0;
            font-weight: bold;
        }

        .exam-cell {
            font-size: 9pt;
        }

        .checkbox-col {
            width: 30px;
        }

        .checkbox-box {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #333;
        }

        .legend {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 12px;
            padding: 8px;
            border: 1px solid #333;
            font-size: 8pt;
        }

        .info-section {
            margin-top: 15px;
            padding: 10px;
            border: 1px solid #333;
            font-size: 8pt;
        }

        .info-section h3 {
            font-size: 10pt;
            margin-bottom: 8px;
        }

        .info-section ul {
            margin-left: 18px;
        }

        .page.rtl .info-section ul {
            margin-left: 0;
            margin-right: 18px;
        }

        .info-section li {
            margin-bottom: 4px;
        }

        .info-section .note {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px dashed #999;
            font-style: italic;
        }

        .system-badge {
            display: inline-block;
            background: #333;
            color: #fff;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 9pt;
            margin-left: 10px;
        }

        .page.rtl .system-badge {
            margin-left: 0;
            margin-right: 10px;
        }

        @media print {
            body {
                background: #fff;
                padding: 0;
            }

            .setup-form,
            .action-buttons,
            .back-btn {
                display: none !important;
            }

            .tables-container {
                display: block !important;
            }

            .page {
                box-shadow: none;
                margin: 0;
                padding: 15px;
                max-width: 100%;
                page-break-after: always;
            }

            .page:last-of-type {
                page-break-after: avoid;
            }
        }
    </style>
</head>
<body>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3 id="loadingText">–°–æ–∑–¥–∞–Ω–∏–µ PDF...</h3>
            <p id="loadingProgress">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</p>
        </div>
    </div>

    <div class="setup-form" id="setupForm">
        <h1>üìñ –ü–ª–∞–Ω –∑–∞—É—á–∏–≤–∞–Ω–∏—è –ö–æ—Ä–∞–Ω–∞</h1>
        
        <div class="form-row">
            <div class="form-group">
                <label>–Ø–∑—ã–∫ —Ç–∞–±–ª–∏—Ü—ã:</label>
                <select id="language" onchange="saveSettings()">
                    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                    <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (–ê—Ä–∞–±—Å–∫–∏–π)</option>
                </select>
            </div>
            <div class="form-group">
                <label>–°—Ç–∏–ª—å —Ü–∏—Ñ—Ä:</label>
                <select id="numerals" onchange="saveSettings()">
                    <option value="western">123 (–ó–∞–ø–∞–¥–Ω—ã–µ)</option>
                    <option value="arabic">Ÿ°Ÿ¢Ÿ£ (–ê—Ä–∞–±—Å–∫–∏–µ)</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label>–£–∂–µ –≤—ã—É—á–µ–Ω–æ (–¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü):</label>
            <div class="form-row">
                <div class="form-group">
                    <input type="number" id="knownFrom" placeholder="–° –∫–∞–∫–æ–π" min="1" max="604" value="3" oninput="updateRecommendation(); saveSettings()">
                </div>
                <div class="form-group">
                    <input type="number" id="knownTo" placeholder="–ü–æ –∫–∞–∫—É—é" min="1" max="604" value="20" oninput="updateRecommendation(); saveSettings()">
                </div>
            </div>
        </div>

        <div class="form-group">
            <label>–° –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—á–∏–Ω–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ:</label>
            <input type="number" id="reviewFrom" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 3" min="1" max="604" value="3" oninput="saveSettings()">
        </div>

        <div class="form-group">
            <label>–°–ª–µ–¥—É—é—â–∞—è –Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:</label>
            <input type="number" id="newPage" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 21" min="1" max="604" value="21" oninput="saveSettings()">
        </div>

        <div class="form-group">
            <label>–°–∫–æ–ª—å–∫–æ —É—á–∏—Ç—å –≤ –¥–µ–Ω—å:</label>
            <select id="dailyAmount" onchange="saveSettings()">
                <option value="0.5">–ü–æ–ª—Å—Ç—Ä–∞–Ω–∏—Ü—ã (¬Ω)</option>
                <option value="1">–û–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞</option>
            </select>
        </div>

        <div class="form-group">
            <label>–ö—Ä—É–≥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è:</label>
            <select id="cycleLength" onchange="updateRecommendation(); saveSettings()">
                <option value="7">7 –¥–Ω–µ–π (1 –Ω–µ–¥–µ–ª—è)</option>
                <option value="14">14 –¥–Ω–µ–π (2 –Ω–µ–¥–µ–ª–∏)</option>
                <option value="21">21 –¥–µ–Ω—å (3 –Ω–µ–¥–µ–ª–∏)</option>
            </select>
            <small>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—ä—ë–º–∞ –≤—ã—É—á–µ–Ω–Ω–æ–≥–æ</small>
        </div>

        <div class="form-group">
            <label>–°–∏—Å—Ç–µ–º–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è:</label>
            <select id="reviewSystem" onchange="saveSettings()">
                <option value="pages">–ü–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º (–¥–æ 2 –¥–∂—É–∑–æ–≤)</option>
                <option value="juz">–ü–æ –¥–∂—É–∑–∞–º (2+ –¥–∂—É–∑–æ–≤)</option>
            </select>
            <small>¬´–ü–æ –¥–∂—É–∑–∞–º¬ª = –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø–æ–≤—Ç–æ—Ä—è–µ—à—å 1 –¥–∂—É–∑ —Ü–µ–ª–∏–∫–æ–º</small>
        </div>

        <div id="recommendationBox" class="info-box auto-detected">
            üìä <strong>–ê–≤—Ç–æ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> <span id="recommendationText">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>

        <button class="btn" onclick="generateTables()">–°–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω</button>
        <button class="btn btn-secondary" onclick="clearSettings()">üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </div>

    <div class="tables-container" id="tablesContainer">
        <div class="action-buttons">
            <button class="print-btn" onclick="window.print()">üñ®Ô∏è –†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å</button>
            <button class="download-btn" id="downloadBtn" onclick="downloadPDF()">üì• –°–∫–∞—á–∞—Ç—å PDF</button>
        </div>
        <button class="back-btn" onclick="goBack()">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º</button>
        
        <div id="tablesContent"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
        const STORAGE_KEY = 'quranPlanSettings';

        const translations = {
            ru: {
                title: 'üìñ –ü–ª–∞–Ω –∑–∞—É—á–∏–≤–∞–Ω–∏—è –ö–æ—Ä–∞–Ω–∞',
                learned: '–í—ã—É—á–µ–Ω–æ:',
                goal: '–¶–µ–ª—å:',
                pace: '–¢–µ–º–ø:',
                cycle: '–ö—Ä—É–≥:',
                days: '–¥–Ω.',
                pagePerDay: '—Å—Ç—Ä./–¥–µ–Ω—å',
                week: '–ù–ï–î–ï–õ–Ø',
                pages: '—Å—Ç—Ä.',
                total: '–ò—Ç–æ–≥–æ:',
                day: '–î–µ–Ω—å',
                hifz: '–•–∏—Ñ–∑ (–Ω–æ–≤–æ–µ)',
                nearReview: '–ë–ª–∏–∂–Ω–µ–µ –ø–æ–≤—Ç.',
                farReview: '–î–∞–ª—å–Ω–µ–µ –ø–æ–≤—Ç.',
                juzReview: '–î–∂—É–∑ –¥–Ω—è',
                prep: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞',
                exam: '–≠–ö–ó–ê–ú–ï–ù:',
                examPart: '–≠–ö–ó–ê–ú–ï–ù (—á–∞—Å—Ç—å):',
                byHeart: '–Ω–∞–∏–∑—É—Å—Ç—å',
                rest: '–û—Ç–¥—ã—Ö / –¥–æ–ø. –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ',
                upper: '–≤–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ–≤–∏–Ω–∞',
                lower: '–Ω–∏–∂–Ω—è—è –ø–æ–ª–æ–≤–∏–Ω–∞',
                times15: '–ø—Ä–æ—á–∏—Ç–∞—Ç—å 15 —Ä–∞–∑',
                page: '—Å—Ç—Ä–∞–Ω–∏—Ü–∞',
                juz: '–¥–∂—É–∑',
                dailySchedule: '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫:',
                afterFajr: '–ü–æ—Å–ª–µ –§–∞–¥–∂—Ä–∞:',
                hifzNew: '–•–∏—Ñ–∑ ‚Äî –∑–∞—É—á–∏–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ',
                afterDhuhr: '–ü–æ—Å–ª–µ –ó—É—Ö—Ä–∞/–ê—Å—Ä–∞:',
                nearReviewDesc: '–ë–ª–∏–∂–Ω–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ (—ç—Ç–∞ –Ω–µ–¥–µ–ª—è)',
                afterAsr: '–ü–æ—Å–ª–µ –ê—Å—Ä–∞:',
                juzReviewDesc: '–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –¥–∂—É–∑–∞ –¥–Ω—è (—Ü–µ–ª–∏–∫–æ–º)',
                afterMaghrib: '–ü–æ—Å–ª–µ –ú–∞–≥—Ä–∏–±–∞:',
                farReviewDesc: '–î–∞–ª—å–Ω–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ (—Å—Ç–∞—Ä—ã–π –±–∞–≥–∞–∂)',
                beforeSleep: '–ü–µ—Ä–µ–¥ —Å–Ω–æ–º:',
                prepDesc: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ ‚Äî —á—Ç–µ–Ω–∏–µ 15 —Ä–∞–∑ + —Å–ª—É—à–∞—Ç—å',
                examDay: '–î–µ–Ω—å —ç–∫–∑–∞–º–µ–Ω–∞:',
                examDayDesc: '–†–∞—Å—Å–∫–∞–∑–∞—Ç—å –≤—Å—ë –Ω–∞–∏–∑—É—Å—Ç—å',
                pageAbbr: '—Å—Ç—Ä.',
                juzAbbr: '–¥–∂.',
                bigVolumeNote: '‚ö†Ô∏è –ü—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä—ë–º–µ (2+ –¥–∂—É–∑–∞): —Ä–∞–∑–¥–µ–ª–∏—Ç–µ —ç–∫–∑–∞–º–µ–Ω –Ω–∞ 2-3 —Å–µ—Å—Å–∏–∏ –∏–ª–∏ –¥–Ω—è.',
                juzSystemNote: 'üìñ –°–∏—Å—Ç–µ–º–∞ ¬´–î–∂—É–∑ –≤ –¥–µ–Ω—å¬ª: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø–æ–≤—Ç–æ—Ä—è–π 1 –¥–∂—É–∑ —Ü–µ–ª–∏–∫–æ–º –ø–æ –∫—Ä—É–≥—É. –≠—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤—è–∑–Ω–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞.',
                twoWeekNote: 'üìÖ –î–≤—É—Ö–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª: –ø–µ—Ä–≤—É—é –Ω–µ–¥–µ–ª—é –ø–æ–≤—Ç–æ—Ä—è–π –ø–µ—Ä–≤—É—é –ø–æ–ª–æ–≤–∏–Ω—É –±–∞–≥–∞–∂–∞, –≤—Ç–æ—Ä—É—é ‚Äî –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω—É.',
                threeWeekNote: 'üìÖ –¢—Ä—ë—Ö–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª (21 –¥–µ–Ω—å): –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è —Ö–∞—Ñ–∏–∑–∞ –≤—Å–µ–≥–æ –ö–æ—Ä–∞–Ω–∞. 1-1.5 –¥–∂—É–∑–∞ –≤ –¥–µ–Ω—å.'
            },
            ar: {
                title: 'üìñ ÿ¨ÿØŸàŸÑ ÿ≠ŸÅÿ∏ ÿßŸÑŸÇÿ±ÿ¢ŸÜ ÿßŸÑŸÉÿ±ŸäŸÖ',
                learned: 'ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏:',
                goal: 'ÿßŸÑŸáÿØŸÅ:',
                pace: 'ÿßŸÑŸàÿ±ÿØ:',
                cycle: 'ÿßŸÑÿØŸàÿ±ÿ©:',
                days: 'ŸäŸàŸÖ',
                pagePerDay: 'ÿµ/ŸäŸàŸÖ',
                week: 'ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ',
                pages: 'ÿµ',
                total: 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπ:',
                day: 'ÿßŸÑŸäŸàŸÖ',
                hifz: 'ÿßŸÑÿ≠ŸÅÿ∏',
                nearReview: 'ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑŸÇÿ±Ÿäÿ®ÿ©',
                farReview: 'ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑÿ®ÿπŸäÿØÿ©',
                juzReview: 'ÿ¨ÿ≤ÿ° ÿßŸÑŸäŸàŸÖ',
                prep: 'ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±',
                exam: 'ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±:',
                examPart: 'ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± (ÿ¨ÿ≤ÿ°):',
                byHeart: 'ÿ∫Ÿäÿ®ÿßŸã',
                rest: 'ÿ±ÿßÿ≠ÿ© / ŸÖÿ±ÿßÿ¨ÿπÿ© ÿ•ÿ∂ÿßŸÅŸäÿ©',
                upper: 'ÿßŸÑŸÜÿµŸÅ ÿßŸÑÿπŸÑŸàŸä',
                lower: 'ÿßŸÑŸÜÿµŸÅ ÿßŸÑÿ≥ŸÅŸÑŸä',
                times15: 'ÿßŸÑŸÇÿ±ÿßÿ°ÿ© Ÿ°Ÿ• ŸÖÿ±ÿ©',
                page: 'ÿµŸÅÿ≠ÿ©',
                juz: 'ÿ¨ÿ≤ÿ°',
                dailySchedule: 'ÿßŸÑÿ®ÿ±ŸÜÿßŸÖÿ¨ ÿßŸÑŸäŸàŸÖŸä:',
                afterFajr: 'ÿ®ÿπÿØ ÿßŸÑŸÅÿ¨ÿ±:',
                hifzNew: 'ÿßŸÑÿ≠ŸÅÿ∏ ÿßŸÑÿ¨ÿØŸäÿØ',
                afterDhuhr: 'ÿ®ÿπÿØ ÿßŸÑÿ∏Ÿáÿ±:',
                nearReviewDesc: 'ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑŸÇÿ±Ÿäÿ®ÿ© (ÿ≠ŸÅÿ∏ Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ)',
                afterAsr: 'ÿ®ÿπÿØ ÿßŸÑÿπÿµÿ±:',
                juzReviewDesc: 'ŸÖÿ±ÿßÿ¨ÿπÿ© ÿ¨ÿ≤ÿ° ÿßŸÑŸäŸàŸÖ (ŸÉÿßŸÖŸÑÿßŸã)',
                afterMaghrib: 'ÿ®ÿπÿØ ÿßŸÑŸÖÿ∫ÿ±ÿ®:',
                farReviewDesc: 'ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑÿ®ÿπŸäÿØÿ© (ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ ÿßŸÑŸÇÿØŸäŸÖ)',
                beforeSleep: 'ŸÇÿ®ŸÑ ÿßŸÑŸÜŸàŸÖ:',
                prepDesc: 'ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ± ‚Äî ŸÇÿ±ÿßÿ°ÿ© Ÿ°Ÿ• ŸÖÿ±ÿ© + ÿßŸÑÿßÿ≥ÿ™ŸÖÿßÿπ',
                examDay: 'ŸäŸàŸÖ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±:',
                examDayDesc: 'ÿ™ÿ≥ŸÖŸäÿπ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏',
                pageAbbr: 'ÿµ',
                juzAbbr: 'ÿ¨',
                bigVolumeNote: '‚ö†Ô∏è ÿπŸÜÿØ ŸÉÿ´ÿ±ÿ© ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ (ÿ¨ÿ≤ÿ¢ŸÜ+): ŸÇÿ≥ŸëŸÖ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± ÿπŸÑŸâ Ÿ¢-Ÿ£ ÿ¨ŸÑÿ≥ÿßÿ™ ÿ£Ÿà ÿ£ŸäÿßŸÖ.',
                juzSystemNote: 'üìñ ŸÜÿ∏ÿßŸÖ ¬´ÿ¨ÿ≤ÿ° ŸÅŸä ÿßŸÑŸäŸàŸÖ¬ª: ÿ±ÿßÿ¨ÿπ ÿ¨ÿ≤ÿ°ÿßŸã ŸÉÿßŸÖŸÑÿßŸã ŸÉŸÑ ŸäŸàŸÖ ÿ®ÿßŸÑÿ™ŸÜÿßŸàÿ®. Ÿáÿ∞ÿß Ÿäÿ≠ÿßŸÅÿ∏ ÿπŸÑŸâ ÿ™ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÜÿµ.',
                twoWeekNote: 'üìÖ ÿØŸàÿ±ÿ© ÿßŸÑÿ£ÿ≥ÿ®ŸàÿπŸäŸÜ: ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿßŸÑÿ£ŸàŸÑ ÿ±ÿßÿ¨ÿπ ÿßŸÑŸÜÿµŸÅ ÿßŸÑÿ£ŸàŸÑÿå ŸàÿßŸÑÿ´ÿßŸÜŸä ÿ±ÿßÿ¨ÿπ ÿßŸÑŸÜÿµŸÅ ÿßŸÑÿ´ÿßŸÜŸä.',
                threeWeekNote: 'üìÖ ÿØŸàÿ±ÿ© Ÿ¢Ÿ° ŸäŸàŸÖÿßŸã: ŸÖÿ´ÿßŸÑŸäÿ© ŸÑÿ≠ÿßŸÅÿ∏ ÿßŸÑŸÇÿ±ÿ¢ŸÜ ÿßŸÑŸÉÿßŸÖŸÑ. Ÿ°-Ÿ°.Ÿ• ÿ¨ÿ≤ÿ° ŸäŸàŸÖŸäÿßŸã.'
            }
        };

        const arabicWeekNames = {
            1: 'ÿßŸÑÿ£ŸàŸÑ', 2: 'ÿßŸÑÿ´ÿßŸÜŸä', 3: 'ÿßŸÑÿ´ÿßŸÑÿ´', 4: 'ÿßŸÑÿ±ÿßÿ®ÿπ',
            5: 'ÿßŸÑÿÆÿßŸÖÿ≥', 6: 'ÿßŸÑÿ≥ÿßÿØÿ≥'
        };

        function saveSettings() {
            const settings = {
                language: document.getElementById('language').value,
                numerals: document.getElementById('numerals').value,
                knownFrom: document.getElementById('knownFrom').value,
                knownTo: document.getElementById('knownTo').value,
                reviewFrom: document.getElementById('reviewFrom').value,
                newPage: document.getElementById('newPage').value,
                dailyAmount: document.getElementById('dailyAmount').value,
                cycleLength: document.getElementById('cycleLength').value,
                reviewSystem: document.getElementById('reviewSystem').value
            };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
        }

        function loadSettings() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                const settings = JSON.parse(saved);
                document.getElementById('language').value = settings.language || 'ru';
                document.getElementById('numerals').value = settings.numerals || 'western';
                document.getElementById('knownFrom').value = settings.knownFrom || 3;
                document.getElementById('knownTo').value = settings.knownTo || 20;
                document.getElementById('reviewFrom').value = settings.reviewFrom || 3;
                document.getElementById('newPage').value = settings.newPage || 21;
                document.getElementById('dailyAmount').value = settings.dailyAmount || '0.5';
                document.getElementById('cycleLength').value = settings.cycleLength || '7';
                document.getElementById('reviewSystem').value = settings.reviewSystem || 'pages';
            }
        }

        function clearSettings() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?')) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        function toArabicNumerals(num) {
            const arabicDigits = ['Ÿ†', 'Ÿ°', 'Ÿ¢', 'Ÿ£', 'Ÿ§', 'Ÿ•', 'Ÿ¶', 'Ÿß', 'Ÿ®', 'Ÿ©'];
            return String(num).split('').map(d => arabicDigits[parseInt(d)] || d).join('');
        }

        function formatNumber(num, useArabic) {
            return useArabic ? toArabicNumerals(num) : String(num);
        }

        function updateRecommendation() {
            const knownFrom = parseInt(document.getElementById('knownFrom').value) || 3;
            const knownTo = parseInt(document.getElementById('knownTo').value) || 20;
            const totalPages = knownTo - knownFrom + 1;
            const juzCount = Math.ceil(totalPages / 20);

            let recommendation = '';
            let suggestedCycle = '7';
            let suggestedSystem = 'pages';

            if (totalPages <= 40) {
                recommendation = `${totalPages} —Å—Ç—Ä. (~${juzCount} –¥–∂—É–∑) ‚Üí –ö—Ä—É–≥ 7 –¥–Ω–µ–π, —Å–∏—Å—Ç–µ–º–∞ ¬´–ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º¬ª`;
                suggestedCycle = '7';
                suggestedSystem = 'pages';
            } else if (totalPages <= 100) {
                recommendation = `${totalPages} —Å—Ç—Ä. (~${juzCount} –¥–∂—É–∑–æ–≤) ‚Üí –ö—Ä—É–≥ 7 –¥–Ω–µ–π, —Å–∏—Å—Ç–µ–º–∞ ¬´–ø–æ –¥–∂—É–∑–∞–º¬ª (1 –¥–∂—É–∑/–¥–µ–Ω—å)`;
                suggestedCycle = '7';
                suggestedSystem = 'juz';
            } else if (totalPages <= 200) {
                recommendation = `${totalPages} —Å—Ç—Ä. (~${juzCount} –¥–∂—É–∑–æ–≤) ‚Üí –ö—Ä—É–≥ 14 –¥–Ω–µ–π, —Å–∏—Å—Ç–µ–º–∞ ¬´–ø–æ –¥–∂—É–∑–∞–º¬ª (1 –¥–∂—É–∑/–¥–µ–Ω—å)`;
                suggestedCycle = '14';
                suggestedSystem = 'juz';
            } else if (totalPages <= 300) {
                recommendation = `${totalPages} —Å—Ç—Ä. (~${juzCount} –¥–∂—É–∑–æ–≤) ‚Üí –ö—Ä—É–≥ 14 –¥–Ω–µ–π, —Å–∏—Å—Ç–µ–º–∞ ¬´–ø–æ –¥–∂—É–∑–∞–º¬ª (1.5 –¥–∂—É–∑–∞/–¥–µ–Ω—å)`;
                suggestedCycle = '14';
                suggestedSystem = 'juz';
            } else {
                recommendation = `${totalPages} —Å—Ç—Ä. (~${juzCount} –¥–∂—É–∑–æ–≤) ‚Üí –ö—Ä—É–≥ 21 –¥–µ–Ω—å, —Å–∏—Å—Ç–µ–º–∞ ¬´–ø–æ –¥–∂—É–∑–∞–º¬ª (1.5 –¥–∂—É–∑–∞/–¥–µ–Ω—å)`;
                suggestedCycle = '21';
                suggestedSystem = 'juz';
            }

            document.getElementById('recommendationText').textContent = recommendation;
            document.getElementById('cycleLength').value = suggestedCycle;
            document.getElementById('reviewSystem').value = suggestedSystem;
            saveSettings();
        }

        async function downloadPDF() {
            const button = document.getElementById('downloadBtn');
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.getElementById('loadingText');
            const loadingProgress = document.getElementById('loadingProgress');
            
            button.disabled = true;
            overlay.style.display = 'flex';

            try {
                const element = document.getElementById('tablesContent');
                const fileName = `quran_plan_${new Date().toISOString().split('T')[0]}.pdf`;
                
                loadingProgress.textContent = '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF...';

                const opt = {
                    margin: 10,
                    filename: fileName,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        letterRendering: true
                    },
                    jsPDF: { 
                        unit: 'mm', 
                        format: 'a4', 
                        orientation: 'portrait' 
                    },
                    pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
                };

                await html2pdf().set(opt).from(element).save();
                
                loadingProgress.textContent = '–ì–æ—Ç–æ–≤–æ!';
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF:', error);
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É "–†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å" –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ PDF —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥ –ø–µ—á–∞—Ç–∏.');
            } finally {
                button.disabled = false;
                setTimeout(() => {
                    overlay.style.display = 'none';
                    loadingText.textContent = '–°–æ–∑–¥–∞–Ω–∏–µ PDF...';
                    loadingProgress.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ';
                }, 1000);
            }
        }

        function generateTables() {
            const language = document.getElementById('language').value;
            const numerals = document.getElementById('numerals').value;
            const knownFrom = parseInt(document.getElementById('knownFrom').value);
            const knownTo = parseInt(document.getElementById('knownTo').value);
            const reviewFrom = parseInt(document.getElementById('reviewFrom').value);
            const newPage = parseInt(document.getElementById('newPage').value);
            const dailyAmount = parseFloat(document.getElementById('dailyAmount').value);
            const cycleLength = parseInt(document.getElementById('cycleLength').value);
            const reviewSystem = document.getElementById('reviewSystem').value;

            if (!knownFrom || !knownTo || !reviewFrom || !newPage) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            const t = translations[language];
            const useArabicNumerals = (numerals === 'arabic');
            const isRTL = (language === 'ar');
            
            let studyDays;
            if (cycleLength === 7) studyDays = 6;
            else if (cycleLength === 14) studyDays = 12;
            else studyDays = 18;
            
            const weeklyPages = dailyAmount * studyDays;
            const dailyText = dailyAmount === 0.5 ? '¬Ω' : formatNumber(1, useArabicNumerals);
            
            let weeksToGenerate;
            if (cycleLength === 7) weeksToGenerate = 4;
            else if (cycleLength === 14) weeksToGenerate = 2;
            else weeksToGenerate = 1;

            let html = '';
            let currentNewPage = newPage;
            let currentKnownTo = knownTo;

            for (let cycle = 1; cycle <= weeksToGenerate; cycle++) {
                const cycleStartPage = currentNewPage;
                const cycleEndPage = currentNewPage + weeklyPages - 1;

                html += generateCyclePage(
                    cycle,
                    reviewFrom,
                    currentKnownTo,
                    cycleEndPage,
                    dailyText,
                    cycleStartPage,
                    cycleEndPage,
                    dailyAmount,
                    reviewFrom,
                    t,
                    useArabicNumerals,
                    isRTL,
                    language,
                    cycleLength,
                    reviewSystem
                );

                currentKnownTo = cycleEndPage;
                currentNewPage = cycleEndPage + 1;
            }

            document.getElementById('tablesContent').innerHTML = html;
            document.getElementById('setupForm').style.display = 'none';
            document.getElementById('tablesContainer').style.display = 'block';
        }

        function generateCyclePage(cycleNum, reviewFrom, knownTo, goalPage, dailyText, cycleStart, cycleEnd, dailyAmount, farReviewStart, t, useArabicNumerals, isRTL, language, cycleLength, reviewSystem) {
            const fn = (n) => formatNumber(n, useArabicNumerals);
            const pageAbbr = t.pageAbbr;
            const juzAbbr = t.juzAbbr;
            
            let studyDays;
            if (cycleLength === 7) studyDays = 6;
            else if (cycleLength === 14) studyDays = 12;
            else studyDays = 18;
            
            const totalDays = cycleLength;

            const totalKnownPages = knownTo - farReviewStart + 1;
            const juzCount = Math.ceil(totalKnownPages / 20);

            let rows = '';
            let currentPage = cycleStart;
            let farReviewCurrent = farReviewStart;

            const reviewPerDay = reviewSystem === 'juz' 
                ? 20 
                : Math.ceil(totalKnownPages / studyDays);

            let currentJuz = 1;

            for (let day = 1; day <= totalDays; day++) {
                let hifz = '';
                let near = '';
                let far = '';
                let prep = '';
                let isExamDay = (day === totalDays);
                let isExamDay1 = (cycleLength === 14 && day === 7) || (cycleLength === 21 && day === 7);
                let isExamDay2 = (cycleLength === 21 && day === 14);

                if (isExamDay || isExamDay1 || isExamDay2) {
                    let examStart, examEnd;
                    
                    if (cycleLength === 14) {
                        if (isExamDay1) {
                            const halfPoint = farReviewStart + Math.floor(totalKnownPages / 2);
                            examStart = farReviewStart;
                            examEnd = halfPoint;
                        } else {
                            examStart = farReviewStart + Math.floor(totalKnownPages / 2) + 1;
                            examEnd = cycleEnd;
                        }
                    } else if (cycleLength === 21) {
                        if (isExamDay1) {
                            examStart = farReviewStart;
                            examEnd = farReviewStart + Math.floor(totalKnownPages / 3);
                        } else if (isExamDay2) {
                            examStart = farReviewStart + Math.floor(totalKnownPages / 3) + 1;
                            examEnd = farReviewStart + Math.floor(totalKnownPages * 2 / 3);
                        } else {
                            examStart = farReviewStart + Math.floor(totalKnownPages * 2 / 3) + 1;
                            examEnd = cycleEnd;
                        }
                    } else {
                        examStart = farReviewStart;
                        examEnd = cycleEnd;
                    }

                    const times15 = useArabicNumerals ? '√óŸ°Ÿ•' : '√ó15';
                    const examPrep = isExamDay 
                        ? (dailyAmount === 0.5
                            ? `${pageAbbr} ${fn(cycleEnd + 1)} ‚Üë ${times15}`
                            : `${pageAbbr} ${fn(cycleEnd + 1)} ${times15}`)
                        : '‚Äî';

                    rows += `
                        <tr class="exam-row">
                            <td class="day-num">${fn(day)}</td>
                            <td colspan="3" class="exam-cell">${isExamDay ? t.exam : t.examPart} ${pageAbbr} ${fn(examStart)}‚Äì${fn(examEnd)} ${t.byHeart}</td>
                            <td>${examPrep}</td>
                            <td><div class="checkbox-box"></div></td>
                        </tr>
                    `;
                    continue;
                }

                if (dailyAmount === 0.5) {
                    const isUpper = (day % 2 === 1);
                    const pageNum = Math.ceil(currentPage);

                    hifz = isUpper 
                        ? `${pageAbbr} ${fn(pageNum)} ‚Üë`
                        : `${pageAbbr} ${fn(Math.floor(currentPage))} ‚Üì`;
                    
                    currentPage += 0.5;

                    if (day === 1) {
                        near = '‚Äî';
                    } else {
                        const learnedHalves = day - 1;
                        const fullPages = Math.floor(learnedHalves / 2);
                        if (fullPages > 0) {
                            near = `${pageAbbr} ${fn(cycleStart)}‚Äì${fn(cycleStart + fullPages - 1)}`;
                            if (learnedHalves % 2 === 1) {
                                near += ` + ${fn(cycleStart + fullPages)}‚Üë`;
                            }
                        } else {
                            near = `${pageAbbr} ${fn(cycleStart)} ‚Üë`;
                        }
                    }

                    const times15 = useArabicNumerals ? '√óŸ°Ÿ•' : '√ó15';
                    if (day < studyDays) {
                        const nextIsUpper = (day % 2 === 0);
                        const nextPage = Math.ceil(currentPage);
                        prep = nextIsUpper 
                            ? `${pageAbbr} ${fn(nextPage)} ‚Üë ${times15}` 
                            : `${pageAbbr} ${fn(Math.floor(currentPage))} ‚Üì ${times15}`;
                    } else {
                        prep = '‚Äî';
                    }
                } else {
                    hifz = `${pageAbbr} ${fn(currentPage)}`;
                    
                    near = day === 1 
                        ? '‚Äî' 
                        : `${pageAbbr} ${fn(cycleStart)}‚Äì${fn(currentPage - 1)}`;

                    const times15 = useArabicNumerals ? '√óŸ°Ÿ•' : '√ó15';
                    prep = day < studyDays 
                        ? `${pageAbbr} ${fn(currentPage + 1)} ${times15}`
                        : '‚Äî';
                    
                    currentPage++;
                }

                if (reviewSystem === 'juz') {
                    const juzStartPage = farReviewStart + (currentJuz - 1) * 20;
                    const juzEndPage = Math.min(juzStartPage + 19, knownTo);
                    far = `${juzAbbr} ${fn(currentJuz)} (${pageAbbr} ${fn(juzStartPage)}‚Äì${fn(juzEndPage)})`;
                    currentJuz++;
                    if (currentJuz > juzCount) currentJuz = 1;
                } else {
                    const farEnd = Math.min(farReviewCurrent + reviewPerDay - 1, knownTo);
                    far = `${pageAbbr} ${fn(farReviewCurrent)}‚Äì${fn(farEnd)}`;
                    farReviewCurrent = farEnd + 1;
                    if (farReviewCurrent > knownTo) {
                        farReviewCurrent = farReviewStart;
                    }
                }

                rows += `
                    <tr>
                        <td class="day-num">${fn(day)}</td>
                        <td>${hifz}</td>
                        <td>${near}</td>
                        <td>${far}</td>
                        <td>${prep}</td>
                        <td><div class="checkbox-box"></div></td>
                    </tr>
                `;
            }

            const times15Legend = useArabicNumerals ? '√óŸ°Ÿ•' : '√ó15';
            
            let cycleName;
            if (language === 'ar') {
                cycleName = `${t.week} ${arabicWeekNames[cycleNum] || fn(cycleNum)}`;
            } else {
                if (cycleLength === 7) {
                    cycleName = `${t.week} ${fn(cycleNum)}`;
                } else if (cycleLength === 14) {
                    cycleName = `–¶–ò–ö–õ ${fn(cycleNum)} (2 –Ω–µ–¥–µ–ª–∏)`;
                } else {
                    cycleName = `–¶–ò–ö–õ ${fn(cycleNum)} (3 –Ω–µ–¥–µ–ª–∏)`;
                }
            }

            const systemBadge = reviewSystem === 'juz' 
                ? (language === 'ar' ? 'ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ¨ÿ≤ÿ°' : '–î–∂—É–∑/–¥–µ–Ω—å')
                : (language === 'ar' ? 'ŸÜÿ∏ÿßŸÖ ÿßŸÑÿµŸÅÿ≠ÿßÿ™' : '–°—Ç—Ä–∞–Ω–∏—Ü—ã');

            let noteText = t.bigVolumeNote;
            if (reviewSystem === 'juz') {
                noteText = t.juzSystemNote;
            }
            if (cycleLength === 14) {
                noteText += ' ' + t.twoWeekNote;
            }
            if (cycleLength === 21) {
                noteText += ' ' + t.threeWeekNote;
            }

            const farReviewLabel = reviewSystem === 'juz' ? t.juzReview : t.farReview;

            return `
                <div class="page ${isRTL ? 'rtl' : ''}">
                    <h1 class="page-title">${t.title} <span class="system-badge">${systemBadge}</span></h1>

                    <div class="header-info">
                        <div class="header-field">
                            <span>${t.learned}</span>
                            <span class="header-value">${pageAbbr} ${fn(farReviewStart)}‚Äì${fn(knownTo)}</span>
                        </div>
                        <div class="header-field">
                            <span>${t.goal}</span>
                            <span class="header-value">${pageAbbr} ${fn(goalPage)}</span>
                        </div>
                        <div class="header-field">
                            <span>${t.pace}</span>
                            <span class="header-value">${dailyText}</span>
                            <span>${t.pagePerDay}</span>
                        </div>
                        <div class="header-field">
                            <span>${t.cycle}</span>
                            <span class="header-value">${fn(cycleLength)}</span>
                            <span>${t.days}</span>
                        </div>
                    </div>

                    <div class="week-title">${cycleName} ‚Äî ${pageAbbr} ${fn(cycleStart)}‚Äì${fn(cycleEnd)} | ${t.total} ${pageAbbr} ${fn(farReviewStart)}‚Äì${fn(cycleEnd)}</div>

                    <table>
                        <thead>
                            <tr>
                                <th>${t.day}</th>
                                <th>${t.hifz}</th>
                                <th>${t.nearReview}</th>
                                <th>${farReviewLabel}</th>
                                <th>${t.prep}</th>
                                <th class="checkbox-col">‚úì</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${rows}
                        </tbody>
                    </table>

                    <div class="legend">
                        <span><b>‚Üë</b> = ${t.upper}</span>
                        <span><b>‚Üì</b> = ${t.lower}</span>
                        <span><b>${times15Legend}</b> = ${t.times15}</span>
                        <span><b>${pageAbbr}</b> = ${t.page}</span>
                        ${reviewSystem === 'juz' ? `<span><b>${juzAbbr}</b> = ${t.juz}</span>` : ''}
                    </div>

                    <div class="info-section">
                        <h3>${t.dailySchedule}</h3>
                        <ul>
                            <li><b>${t.afterFajr}</b> ${t.hifzNew}</li>
                            <li><b>${t.afterDhuhr}</b> ${t.nearReviewDesc}</li>
                            ${reviewSystem === 'juz' ? `<li><b>${t.afterAsr}</b> ${t.juzReviewDesc}</li>` : ''}
                            <li><b>${t.afterMaghrib}</b> ${t.farReviewDesc}</li>
                            <li><b>${t.beforeSleep}</b> ${t.prepDesc}</li>
                            <li><b>${t.examDay}</b> ${t.examDayDesc}</li>
                        </ul>
                        <div class="note">${noteText}</div>
                    </div>
                </div>
            `;
        }

        function goBack() {
            document.getElementById('setupForm').style.display = 'block';
            document.getElementById('tablesContainer').style.display = 'none';
        }

        window.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            updateRecommendation();
        });
    </script>

</body>
</html>
